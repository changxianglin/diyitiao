<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>spa</title>
    </head>
    <body>
        <div class="wrapper">
            <ul class="navigator">
                <li class="nav-item">
                    green
                </li>
                <li class="nav-item">
                    blue
                </li>
                <li class="nav-item">
                    red
                </li>
            </ul>
            <div class="content">
            </div>
        </div>
        <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js">
        </script>
        <script type="text/javascript">
            var menu = $("ul.navigator > li")
            var content = $('div.content')
            function initPage(page) {
                menu.removeClass('selected-item')
                menu.filter(function() {
                    return $(this).text().toLowerCase().trim() === page
                }).addClass('selected-item')
                content.text('this is a ' + page + ' page')
            }
            initPage(location.pathname.substring(1))
            menu.on('click', function() {
                var page = $(this).text().toLowerCase().trim()
                initPage(page)
                history.pushState("", page, page)
            })
            window.addEventListener('popstate', function(e) {
                initPage(location.substring(1))
            })
        </script>
    </body>
</html>
