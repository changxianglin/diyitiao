<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>index05</title>
  </head>
  <body>
    <select class="" name="" id = 'colorSelect'>
      <option value="">请选择</option>
      <option value="red">红色</option>
      <option value="blue">蓝色</option>
    </select>
    <select class="" name="" id = 'memorySelect'>
      <option value="">请选择</option>
      <option value="32G">32G</option>
      <option value="16G">16G</option>
    </select>
    <input type="text" name="" value="" id = 'numberInput'><br>

    <div class="" id = 'colorInfo'></div><br>
    <div class="" id = 'memoryInfo'></div><br>
    <div class="" id = 'numberInfo'></div><br>

    <button type="button" name="button" id = 'nextBtn' disabled = 'true'>请选择手机颜色和数量</button>

    <script type="text/javascript">
      var colorSelect = document.getElementById('colorSelect')
      var numberInput = document.getElementById('numberInfo')
      var memorySelect = document.getElementById('memorySelect')
      var colorInfo = document.getElementById('colorInfo')
      var memoryInfo = document.getElementById('memorySelect')
      var nextBtn = document.getElementById('nextBtn')

      var goods = {
        'red|32G': 3,
        'red|16G': 0,
        'blue|32G': 1,
        'blue|16G': 6
      }

      colorSelect.onchange = function() {
        var color = this.value
        var memory = memorySelect.value
        var stock = goods[color + '|' + memory]

        number = numberInput.value
        colorInfo.innerHTML = color

        if(!color) {
          nextBtn.disabled = true
          nextBtn.innerHTML = '请选择手机颜色'
          return
        }
        if(!memory) {
          nextBtn.disabled = true
          nextBtn.innerHTML = '请选择内存大小'
          return
        }
        if(Number.isInteger(number - 0) && number > 0) {
          nextBtn.disabled = true
          nextBtn.innerHTML = '请输入正确的购买数量'
          return
        }
        if(number > stock) {
          nextBtn.disabled = true
          nextBtn.innerHTML = '库存不足'
          return
        }

        nextBtn.disabled = false
        nextBtn.innerHTML = '请放入购物车'
      }

      numberInput.oninput = function() {
        var color = colorSelect.value
        var number = this.value
        var stock = goods[color]

        numberInfo.innerHTML = number

        if(!color) {
          nextBtn.disabled = true
          nextBtn.innerHTML = '请选择手机颜色'
          return
        }

        if(((number - 0) | 0) !== number - 0) {
          nextBtn.disabled = true
          nextBtn.innerHTML = '请输入正确的购买数量'
          return
        }

        if(number > stock) {
          nextBtn.disabled = true
          nextBtn.innerHTML = '库存不足'
          return
        }

        nextBtn.disabled = false
        nextBtn.innerHTML = '放入购物车'
      }

      memorySelect.onchange = function() {
        var color = colorSelect.value
        var number = numberInput.value
        var memory = this.value
        var stock = goods[color + '|' + memory]
        memoryInfo.innerHTML = memory

        if(!color) {
          nextBtn.disabled = true
          nextBtn.innerHTML = '选择手机颜色'
          return
        }
        if(!memory) {
          nextBtn.disabled = true
          nextBtn.innerHTM = '请选择内存大小'
          return
        }
        if(Number.isInteger(number - 0) && number > 0) {
          nextBtn.disabled = true
          nextBtn.innerHTM = '去输入正确的购买数量'
        }
        if(number > stock) {
          nextBtn.disabled = true
          nextBtn.innerHTM = '库存不足'
          return
        }

        nextBtn.disabled = false
        nextBtn.innerHTM = '放入购物车'
      }
    </script>
  </body>
</html>
