<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>index05</title>
  </head>
  <body>
    <script type="text/javascript">
      window.external.upload = function(state) {
        console.log(state)
      }

      var plugin = (function() {
        var plugin = document.createElement('embed')
        plugin.style.display = 'none'

        plugin.type = 'application/txftn-webkit'

        plugin.sign = function() {
          console.log('开始文件扫描')
        }
        plugin.pause = function() {
          console.log('暂停文件上传')
        }
        plugin.uploading = function() {
          console.log('开始文件上传')
        }
        plugin.del = function() {
          console.log('删除文件')
        }
        plugin.done = function() {
          console.log('文件上传完成')
        }

        document.body.appendChild(plugin)

        return plugin
      })()

      var Upload = function(fileName) {
        this.plugin = plugin
        this.fileName = fileName
        this.button1 = null
        this.button2 = null
        this.state = 'sign'
      }

      Upload.prototype.init = function() {
        var that = this
        this.dom = document.createElement('div')
        this.dom.innerHTML = '<span>文件名称：' + this.fileName + '</span>\
        <button data-action = "button1">扫描中</button>\
        <button data-action = "button2"> 删除</button>'

        document.body.appendChild(this.dom)
        this.button1 = this.dom.querySelector('[data-action="button1"]')
        this.button2 = this.dom.querySelector('[data-action="button2"]')
        this.bindEvent()
      }
    </script>
  </body>
</html>
